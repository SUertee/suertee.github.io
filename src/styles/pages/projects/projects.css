@layer components {
  .projects-page {
    @apply space-y-8 pb-14 md:space-y-10;
  }

  .reveal-block {
    opacity: 0;
    transform: translateY(18px);
    filter: blur(8px);
    transition:
      opacity 520ms ease,
      transform 560ms cubic-bezier(0.2, 0.8, 0.2, 1),
      filter 520ms ease;
    transition-delay: var(--reveal-delay, 0ms);
    will-change: opacity, transform, filter;
  }

  .projects-page.is-mounted .reveal-block {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }

  .projects-header {
    @apply flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between;
  }

  .projects-lede {
    @apply space-y-2;
  }

  .projects-kicker {
    @apply text-[11px] uppercase tracking-[0.3em] text-indigo-300;
  }

  .projects-title {
    @apply text-2xl font-semibold text-neutral-50 sm:text-3xl;
  }

  .projects-intro {
    @apply max-w-2xl text-sm text-neutral-300;
  }

  /* Folder wrapper */

  .projects-folder {
    position: relative;
    overflow: hidden;
    border-radius: 1.25rem;
    border: 1px solid rgba(255, 255, 255, 0.06);
    background: radial-gradient(
        circle at 20% 20%,
        rgba(129, 140, 248, 0.14),
        transparent 38%
      ),
      radial-gradient(
        circle at 80% 10%,
        rgba(52, 211, 153, 0.1),
        transparent 40%
      ),
      linear-gradient(135deg, rgba(8, 47, 73, 0.85), rgba(12, 10, 24, 0.92));
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
    padding: 1.5rem;
  }

  .projects-folder.is-timeline-entry {
    animation: folder-sweep-in 880ms cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
  }

  .projects-folder::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom right,
      rgba(255, 255, 255, 0.03),
      rgba(255, 255, 255, 0)
    );
    pointer-events: none;
  }

  .view-toggle {
    @apply mb-3 flex flex-wrap gap-2;
  }

  .view-toggle-btn {
    @apply rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-[0.15em] text-neutral-200 transition;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(255, 255, 255, 0.04);
  }

  .view-toggle-btn.is-active {
    border-color: rgba(129, 140, 248, 0.5);
    color: #0b0c16;
    background: linear-gradient(
      135deg,
      color-mix(in oklab, var(--project-accent, #8b5cf6) 70%, #ffffff 25%),
      color-mix(in oklab, var(--project-accent, #8b5cf6) 50%, #22d3ee 20%)
    );
    box-shadow: 0 0 18px color-mix(in oklab, var(--project-accent, #8b5cf6) 40%, #22d3ee 20%);
  }

  .scatter-card {
    position: absolute;
    left: 50%;
    top: 45%;
    width: clamp(200px, 82vw, 320px);
    border-radius: 1.05rem;
    padding: 1.1rem 1.05rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transform: var(--card-transform, translate(-50%, -50%));
    background: linear-gradient(
        140deg,
        rgba(255, 255, 255, 0.06),
        rgba(255, 255, 255, 0)
      ),
      linear-gradient(180deg, rgba(8, 8, 12, 0.92), rgba(15, 23, 42, 0.85));
    color: #e5e7eb;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.55);
    transition:
      transform 420ms cubic-bezier(0.2, 0.8, 0.2, 1),
      box-shadow 220ms ease,
      border-color 220ms ease,
      filter 220ms ease;
    cursor: grab;
    animation: none;
  }

  .scatter-card.is-dealing {
    opacity: 0;
    transform: translate(-50%, 32%) scale(0.68) rotate(-6deg);
    animation: scatter-deal 640ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-delay: var(--stagger-delay, 0ms);
  }

  .scatter-card.is-active {
    border-color: color-mix(in oklab, var(--project-accent, #8b5cf6) 60%, #ffffff 10%);
    filter: drop-shadow(0 12px 35px rgba(0, 0, 0, 0.5));
    transform: var(--card-transform) scale(1.05);
    z-index: 120 !important;
    animation: project-pop 380ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .scatter-card:hover {
    z-index: 200 !important;
    filter: drop-shadow(0 14px 45px rgba(0, 0, 0, 0.55));
    transform: var(--card-transform) scale(1.04);
    border-color: color-mix(in oklab, var(--project-accent, #8b5cf6) 40%, #ffffff 8%);
    cursor: grabbing;
  }

  .scatter-card-top {
    @apply flex items-center gap-2 text-sm;
  }

  .scatter-dot {
    width: 8px;
    height: 8px;
    border-radius: 9999px;
    background: var(--project-accent, #8b5cf6);
    box-shadow: 0 0 10px var(--project-accent, #8b5cf6);
  }

  .scatter-title {
    @apply font-semibold text-white;
  }

  .scatter-period {
    @apply ml-auto text-[11px] uppercase tracking-wider text-neutral-400;
  }

  .scatter-role {
    @apply mt-1 text-xs text-indigo-200;
  }

  .scatter-tags {
    @apply mt-2 flex flex-wrap gap-1;
  }

  .scatter-tag {
    @apply rounded-full bg-white/5 px-2 py-0.5 text-[11px] text-neutral-200;
    border: 1px solid rgba(255, 255, 255, 0.06);
  }

  /* @media (max-width: 640px) {
    .scatter-card {
      width: clamp(180px, 88vw, 260px);
      top: 50%;
      padding: 0.95rem 0.9rem;
    }
    .scatter-card.is-active {
      transform: var(--card-transform) scale(1.03);
    }
    .scatter-card:hover {
      transform: var(--card-transform) scale(1.02);
    }
  }

  @media (max-width: 480px) {
    .scatter-card {
      width: clamp(170px, 92vw, 240px);
      top: 52%;
      padding: 0.85rem 0.8rem;
    }
  } */

  @keyframes folder-sweep-in {
    from {
      opacity: 0;
      transform: translateX(-18px);
      clip-path: inset(0 24% 0 0);
      filter: blur(6px);
    }
    60% {
      opacity: 1;
    }
    to {
      opacity: 1;
      transform: translateX(0);
      clip-path: inset(0 0 0 0);
      filter: blur(0);
    }
  }

  /* Showcase layout */

  .project-showcase {
    display: grid;
    gap: 1.5rem;
    align-items: start;
    transition: opacity 240ms ease, transform 260ms ease, filter 260ms ease;
  }

  .project-showcase.is-hidden {
    display: none;
    opacity: 0;
    transform: translateY(10px) scale(0.98);
    filter: blur(2px);
    pointer-events: none;
    visibility: hidden;
  }

  .project-showcase.is-visible {
    display: grid;
    visibility: visible;
  }

  @media (min-width: 960px) {
    .project-showcase {
      grid-template-columns: 1.05fr 0.95fr;
    }
  }

  .project-copy {
    @apply space-y-3 rounded-2xl border border-white/5 bg-neutral-950/80 p-5;
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.45);
    opacity: 0.1;
    transform: translateY(10px);
    transition: opacity 300ms ease, transform 380ms ease;
  }

  .project-copy.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .project-copy.is-visible .project-description {
    animation: fadeUp 360ms ease forwards;
    animation-delay: 120ms;
    opacity: 0;
  }

  .project-copy.is-visible .project-highlights {
    animation: fadeUp 380ms ease forwards;
    animation-delay: 180ms;
    opacity: 0;
  }

  .project-copy.is-hidden {
    opacity: 0.35;
  }

  .project-selected-pill {
    @apply inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-neutral-950;
    background: color-mix(in oklab, var(--project-accent, #8b5cf6) 75%, #ffffff 25%);
    box-shadow: 0 0 16px color-mix(in oklab, var(--project-accent, #8b5cf6) 40%, #22d3ee 20%);
    animation: popIn 280ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .project-placeholder {
    @apply py-10 text-sm text-neutral-300;
  }

  .project-meta {
    @apply text-xs uppercase tracking-[0.2em] text-neutral-400;
  }

  .project-headline {
    @apply text-xl font-semibold text-white sm:text-2xl;
  }

  .project-description {
    @apply text-sm leading-relaxed text-neutral-300;
  }

  .project-highlights {
    @apply space-y-2 text-sm text-neutral-200;
  }

  .project-highlight {
    @apply flex items-start gap-2;
  }

  .project-highlight-dot {
    margin-top: 7px;
    width: 7px;
    height: 7px;
    border-radius: 9999px;
    background: var(--project-accent, #8b5cf6);
    box-shadow: 0 0 12px var(--project-accent, #8b5cf6);
  }

  .project-tags {
    @apply flex flex-wrap gap-1;
  }

  .project-tag {
    @apply rounded-full bg-white/5 px-2 py-0.5 text-[11px] text-neutral-200;
    border: 1px solid rgba(255, 255, 255, 0.08);
  }

  .project-links {
    @apply flex flex-wrap items-center justify-between gap-3 pt-1;
  }

  .project-link {
    @apply text-xs font-semibold text-indigo-200 transition hover:text-white;
  }

  .project-media {
    position: relative;
    opacity: 0.05;
    transform: translateY(16px);
    transition: opacity 300ms ease, transform 400ms ease;
  }

  .project-media.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .project-media.is-visible .project-media-frame {
    animation: fadeUp 380ms ease forwards;
    animation-delay: 220ms;
    opacity: 0;
  }

  .project-media.is-hidden {
    opacity: 0.25;
  }

  .project-media-frame {
    position: relative;
    border-radius: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    padding: 1.25rem;
    background: radial-gradient(
        circle at 20% 20%,
        color-mix(in oklab, var(--project-accent, #8b5cf6) 35%, #0f172a 80%),
        transparent 45%
      ),
      linear-gradient(145deg, rgba(15, 23, 42, 0.95), rgba(5, 7, 15, 0.95));
    box-shadow: 0 18px 50px rgba(0, 0, 0, 0.55);
    overflow: hidden;
  }

  .project-media-header {
    @apply flex items-center justify-between gap-3;
    margin-bottom: 0.75rem;
  }

  .project-media-pill {
    @apply rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-neutral-900;
    background: color-mix(
      in oklab,
      var(--project-accent, #8b5cf6) 75%,
      #ffffff 25%
    );
    box-shadow: 0 0 20px color-mix(
        in oklab,
        var(--project-accent, #8b5cf6) 50%,
        #22d3ee 20%
      );
  }

  .project-media-label {
    @apply text-sm font-semibold text-white;
  }

  .project-media-display {
    position: relative;
    border-radius: 1.1rem;
    padding: 1rem;
    background: linear-gradient(
        160deg,
        rgba(255, 255, 255, 0.04),
        rgba(255, 255, 255, 0)
      ),
      radial-gradient(
        circle at 80% 10%,
        color-mix(in oklab, var(--project-accent, #8b5cf6) 40%, transparent 40%),
        transparent 50%
      ),
      #0b1224;
    border: 1px solid rgba(255, 255, 255, 0.06);
    min-height: 220px;
    display: grid;
    place-items: center;
    overflow: hidden;
  }

  .project-media-asset {
    width: 100%;
    max-width: 640px;
    height: 100%;
    max-height: 340px;
    object-fit: cover;
    border-radius: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    background: #0b1224;
    box-shadow: 0 14px 40px rgba(0, 0, 0, 0.45);
  }

  .media-window {
    width: 100%;
    max-width: 520px;
    aspect-ratio: 16 / 9;
    border-radius: 1rem;
    background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.05),
        rgba(255, 255, 255, 0)
      ),
      color-mix(in oklab, var(--project-accent, #8b5cf6) 8%, #020617 92%);
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
  }

  .media-play {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    font-size: 1.75rem;
    color: color-mix(in oklab, var(--project-accent, #8b5cf6) 90%, #ffffff 10%);
    opacity: 0.9;
  }

  .media-bars {
    position: absolute;
    left: 18px;
    bottom: 18px;
    display: flex;
    gap: 6px;
  }

  .media-bars span {
    display: block;
    width: 48px;
    height: 6px;
    border-radius: 9999px;
    background: color-mix(in oklab, var(--project-accent, #8b5cf6) 70%, #22d3ee 20%);
    opacity: 0.6;
  }

  .media-bars span:nth-child(2) {
    width: 66px;
    opacity: 0.9;
  }

  .media-bars span:nth-child(3) {
    width: 36px;
    opacity: 0.5;
  }

  .media-pip {
    position: absolute;
    right: 12px;
    bottom: 12px;
    display: grid;
    gap: 6px;
    padding: 0.65rem;
    border-radius: 1rem;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.08);
  }

  .media-pip span {
    display: block;
    width: 72px;
    height: 8px;
    border-radius: 9999px;
    background: rgba(255, 255, 255, 0.15);
  }

  .project-media-caption {
    @apply mt-3 text-sm text-neutral-200;
  }

  @keyframes project-pop {
    0% {
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    60% {
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.45);
    }
    100% {
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.55);
    }
  }

  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes popIn {
    0% {
      opacity: 0;
      transform: scale(0.8);
    }
    60% {
      opacity: 1;
      transform: scale(1.05);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes scatter-deal {
    0% {
      opacity: 0;
      transform: translate(calc(-50% + var(--deal-offset, 0px)), 40%)
        scale(0.64) rotate(-10deg);
      filter: blur(6px);
    }
    60% {
      opacity: 1;
      transform: translate(calc(-50% + var(--deal-offset, 0px)), -8%)
        scale(0.98) rotate(1deg);
      filter: blur(1px);
    }
    100% {
      opacity: 1;
      transform: var(--card-transform);
      filter: blur(0);
    }
  }
}
